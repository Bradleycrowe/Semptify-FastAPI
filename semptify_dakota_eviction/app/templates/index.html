{% extends "layouts/base.html" %}

{% block title %}{{ strings.title_main }}{% endblock %}

{% block content %}
<div class="text-center mb-2">
    <h1 style="font-size: 2rem; margin-bottom: 0.5rem;">{{ strings.title_main }}</h1>
    <p style="font-size: 1.1rem; color: var(--text-light);">
        {% if lang == 'en' %}
        Your complete guide to fighting eviction in Dakota County, Minnesota
        {% elif lang == 'es' %}
        Su guÃ­a completa para luchar contra el desalojo en el condado de Dakota, Minnesota
        {% elif lang == 'so' %}
        Hagahaaga dhamaystiran ee la dagaalanka ka-saarista ee Degmada Dakota, Minnesota
        {% else %}
        Ø¯Ù„ÙŠÙ„Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù…Ø­Ø§Ø±Ø¨Ø© Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡ ÙÙŠ Ù…Ù‚Ø§Ø·Ø¹Ø© Ø¯Ø§ÙƒÙˆØªØ§ØŒ Ù…ÙŠÙ†ÙŠØ³ÙˆØªØ§
        {% endif %}
    </p>
</div>

<!-- Deadline Calculator Widget -->
<div class="card" style="background: linear-gradient(135deg, #fef3c7 0%, #fef9c3 100%); border: 2px solid #f59e0b;">
    <div class="card-header">
        <div class="card-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">â°</div>
        <div>
            <h2 class="card-title">
                {% if lang == 'en' %}When were you served?{% elif lang == 'es' %}Â¿CuÃ¡ndo le notificaron?{% elif lang == 'so' %}Goorma laguu soo gaarsiiey?{% else %}Ù…ØªÙ‰ ØªÙ… ØªØ¨Ù„ÙŠØºÙƒØŸ{% endif %}
            </h2>
            <p class="card-description">
                {% if lang == 'en' %}Enter the date you received eviction papers to see your deadlines{% elif lang == 'es' %}Ingrese la fecha en que recibiÃ³ los documentos de desalojo{% elif lang == 'so' %}Geli taariikhda aad heshay waraaqaha ka-saarista{% else %}Ø£Ø¯Ø®Ù„ ØªØ§Ø±ÙŠØ® Ø§Ø³ØªÙ„Ø§Ù… Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡{% endif %}
            </p>
        </div>
    </div>
    <div class="flex gap-2 items-center" style="flex-wrap: wrap;">
        <input type="date" id="servedDate" class="form-input" style="max-width: 200px;">
        <button onclick="calculateDeadline()" class="btn btn-primary">
            {% if lang == 'en' %}Calculate{% elif lang == 'es' %}Calcular{% elif lang == 'so' %}Xisaabi{% else %}Ø§Ø­Ø³Ø¨{% endif %}
        </button>
        <div id="deadlineResult" style="font-weight: 600; font-size: 1.1rem; color: #b45309;"></div>
    </div>
</div>

<!-- Main Action Cards -->
<h2 class="mt-4 mb-2">
    {% if lang == 'en' %}What do you need help with?{% elif lang == 'es' %}Â¿Con quÃ© necesita ayuda?{% elif lang == 'so' %}Maxay tahay waxaad caawimaad u baahan tahay?{% else %}Ù…Ø§ Ø§Ù„Ø°ÙŠ ØªØ­ØªØ§Ø¬ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠÙ‡ØŸ{% endif %}
</h2>

<div class="grid grid-2">
    <!-- File Answer -->
    <a href="/flows/answer?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">ğŸ“</div>
            <div>
                <h3 class="card-title">{{ strings.nav_answer }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            Respond to an eviction complaint. Tell the court your side of the story and assert your defenses.
            {% elif lang == 'es' %}
            Responda a una demanda de desalojo. Cuente su versiÃ³n al tribunal y presente sus defensas.
            {% elif lang == 'so' %}
            Ka jawaab dacwadda ka-saarista. U sheeg maxkamadda dhinacaaga oo soo bandhig difaacyadaada.
            {% else %}
            Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø´ÙƒÙˆÙ‰ Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡. Ø£Ø®Ø¨Ø± Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø¨Ø¬Ø§Ù†Ø¨Ùƒ Ù…Ù† Ø§Ù„Ù‚ØµØ© ÙˆÙ‚Ø¯Ù… Ø¯ÙØ§Ø¹Ø§ØªÙƒ.
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
    
    <!-- Counterclaim -->
    <a href="/flows/counterclaim?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">âš–ï¸</div>
            <div>
                <h3 class="card-title">{{ strings.nav_counterclaim }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            Sue your landlord back. Claim damages for repairs, deposit issues, illegal fees, or other violations.
            {% elif lang == 'es' %}
            Demande a su arrendador. Reclame daÃ±os por reparaciones, depÃ³sito, cargos ilegales u otras violaciones.
            {% elif lang == 'so' %}
            Dacwee mulkiilahaaga. Codsiga khasaaraha dayactirka, lacagta dammaanadda, kharashka sharciga darroga.
            {% else %}
            Ù‚Ø§Ø¶Ù Ø§Ù„Ù…Ø§Ù„Ùƒ. Ø§Ø·Ù„Ø¨ ØªØ¹ÙˆÙŠØ¶Ø§Øª Ø¹Ù† Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø£Ùˆ Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø£Ùˆ Ø§Ù„Ø±Ø³ÙˆÙ… ØºÙŠØ± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©.
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
    
    <!-- Motions -->
    <a href="/flows/motions?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">ğŸ“‹</div>
            <div>
                <h3 class="card-title">{{ strings.nav_motions }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            File a motion to dismiss, request a continuance, stay a writ, or waive filing fees.
            {% elif lang == 'es' %}
            Presente una mociÃ³n para desestimar, solicitar aplazamiento, suspender orden o eximir tarifas.
            {% elif lang == 'so' %}
            Xaree codsiga joojinta, dib u dhigida, hakinta amarka, ama cafinta kharashka.
            {% else %}
            Ù‚Ø¯Ù… Ø·Ù„Ø¨ Ø±ÙØ¶ Ø£Ùˆ ØªØ£Ø¬ÙŠÙ„ Ø£Ùˆ ÙˆÙ‚Ù Ø£Ù…Ø± Ø£Ùˆ Ø¥Ø¹ÙØ§Ø¡ Ù…Ù† Ø§Ù„Ø±Ø³ÙˆÙ….
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
    
    <!-- Hearing Prep -->
    <a href="/flows/hearing?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">ğŸ¯</div>
            <div>
                <h3 class="card-title">{{ strings.nav_hearing }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            Get ready for court. Checklists, what to bring, how to present your case, and what to expect.
            {% elif lang == 'es' %}
            PrepÃ¡rese para el tribunal. Listas de verificaciÃ³n, quÃ© traer, cÃ³mo presentar su caso.
            {% elif lang == 'so' %}
            U diyaargarow maxkamadda. Liisaska, waxa la keenayo, sida loo soo bandhigo kiiskaaga.
            {% else %}
            Ø§Ø³ØªØ¹Ø¯ Ù„Ù„Ù…Ø­ÙƒÙ…Ø©. Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©ØŒ Ù…Ø§ ÙŠØ¬Ø¨ Ø¥Ø­Ø¶Ø§Ø±Ù‡ØŒ ÙƒÙŠÙÙŠØ© ØªÙ‚Ø¯ÙŠÙ… Ù‚Ø¶ÙŠØªÙƒ.
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
    
    <!-- Forms Library -->
    <a href="/forms/library?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">ğŸ“š</div>
            <div>
                <h3 class="card-title">{{ strings.nav_forms }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            Download official Minnesota court forms. Answer forms, motions, fee waivers, and more.
            {% elif lang == 'es' %}
            Descargue formularios oficiales del tribunal de Minnesota. Formularios de respuesta, mociones y mÃ¡s.
            {% elif lang == 'so' %}
            Soo deji foomamka rasmiga ah ee maxkamadda Minnesota. Foomamka jawaabta, codsiyada, iwm.
            {% else %}
            ØªØ­Ù…ÙŠÙ„ Ù†Ù…Ø§Ø°Ø¬ Ù…Ø­ÙƒÙ…Ø© Ù…ÙŠÙ†ÙŠØ³ÙˆØªØ§ Ø§Ù„Ø±Ø³Ù…ÙŠØ©. Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø±Ø¯ØŒ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ ÙˆØ§Ù„Ù…Ø²ÙŠØ¯.
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
    
    <!-- Zoom Court -->
    <a href="/zoom-helper?lang={{ lang }}" class="card" style="text-decoration: none; color: inherit;">
        <div class="card-header">
            <div class="card-icon">ğŸ’»</div>
            <div>
                <h3 class="card-title">{{ strings.nav_zoom }}</h3>
            </div>
        </div>
        <p class="card-description">
            {% if lang == 'en' %}
            Virtual court appearance guide. Tech tips, etiquette, and how to present yourself professionally.
            {% elif lang == 'es' %}
            GuÃ­a de comparecencia virtual. Consejos tÃ©cnicos, etiqueta y cÃ³mo presentarse profesionalmente.
            {% elif lang == 'so' %}
            Hagaha muuqaalka maxkamadda. Talooyin farsamooyinka, hab-dhaqanka, sida loo soo bandhigo si xirfad leh.
            {% else %}
            Ø¯Ù„ÙŠÙ„ Ø§Ù„Ù…Ø«ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ. Ù†ØµØ§Ø¦Ø­ ØªÙ‚Ù†ÙŠØ©ØŒ Ø¢Ø¯Ø§Ø¨ØŒ ÙˆÙƒÙŠÙÙŠØ© ØªÙ‚Ø¯ÙŠÙ… Ù†ÙØ³Ùƒ Ø¨Ø§Ø­ØªØ±Ø§ÙÙŠØ©.
            {% endif %}
        </p>
        <div class="mt-2">
            <span class="btn btn-primary">
                {{ strings.btn_next }} â†’
            </span>
        </div>
    </a>
</div>

<!-- Emergency Resources -->
<div class="alert alert-danger mt-4">
    <div class="alert-icon">ğŸš¨</div>
    <div>
        <strong>
            {% if lang == 'en' %}Need immediate help?{% elif lang == 'es' %}Â¿Necesita ayuda inmediata?{% elif lang == 'so' %}Ma u baahan tahay caawimaad degdeg ah?{% else %}Ù‡Ù„ ØªØ­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙˆØ±ÙŠØ©ØŸ{% endif %}
        </strong>
        <p>
            {% if lang == 'en' %}
            Call HomeLine Tenant Hotline: <strong>612-728-5767</strong> (Free legal advice for Minnesota tenants)
            {% elif lang == 'es' %}
            Llame a HomeLine: <strong>612-728-5767</strong> (Asesoramiento legal gratuito para inquilinos de Minnesota)
            {% elif lang == 'so' %}
            Wac HomeLine: <strong>612-728-5767</strong> (Talo sharci oo bilaash ah oo loogu talagalay kireystayaasha Minnesota)
            {% else %}
            Ø§ØªØµÙ„ Ø¨Ù€ HomeLine: <strong>612-728-5767</strong> (Ø§Ø³ØªØ´Ø§Ø±Ø© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ© Ù„Ù„Ù…Ø³ØªØ£Ø¬Ø±ÙŠÙ† ÙÙŠ Ù…ÙŠÙ†ÙŠØ³ÙˆØªØ§)
            {% endif %}
        </p>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function calculateDeadline() {
    const input = document.getElementById('servedDate');
    const result = document.getElementById('deadlineResult');
    
    if (!input.value) {
        result.textContent = '{% if lang == "en" %}Please enter a date{% elif lang == "es" %}Por favor ingrese una fecha{% elif lang == "so" %}Fadlan geli taariikh{% else %}ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±ÙŠØ®{% endif %}';
        return;
    }
    
    const served = new Date(input.value);
    const deadline = new Date(served);
    deadline.setDate(deadline.getDate() + 7);
    
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    const daysLeft = Math.ceil((deadline - today) / (1000 * 60 * 60 * 24));
    
    const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    const deadlineStr = deadline.toLocaleDateString('{% if lang == "es" %}es-ES{% elif lang == "ar" %}ar-SA{% else %}en-US{% endif %}', options);
    
    if (daysLeft < 0) {
        result.innerHTML = 'âš ï¸ {% if lang == "en" %}Deadline PASSED{% elif lang == "es" %}Fecha lÃ­mite PASADA{% elif lang == "so" %}Wakhtiga wuu DHAAFAY{% else %}Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ù…ÙˆØ¹Ø¯{% endif %}! ' + deadlineStr;
        result.style.color = '#dc2626';
    } else if (daysLeft === 0) {
        result.innerHTML = 'ğŸš¨ {% if lang == "en" %}TODAY IS THE DEADLINE{% elif lang == "es" %}HOY ES LA FECHA LÃMITE{% elif lang == "so" %}MAANTA AYAA WAKHTIGA{% else %}Ø§Ù„ÙŠÙˆÙ… Ù‡Ùˆ Ø§Ù„Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ{% endif %}!';
        result.style.color = '#dc2626';
    } else if (daysLeft <= 3) {
        result.innerHTML = 'â° ' + daysLeft + ' {% if lang == "en" %}days left{% elif lang == "es" %}dÃ­as restantes{% elif lang == "so" %}maalmood haray{% else %}Ø£ÙŠØ§Ù… Ù…ØªØ¨Ù‚ÙŠØ©{% endif %} â†’ ' + deadlineStr;
        result.style.color = '#d97706';
    } else {
        result.innerHTML = 'ğŸ“… ' + deadlineStr + ' (' + daysLeft + ' {% if lang == "en" %}days{% elif lang == "es" %}dÃ­as{% elif lang == "so" %}maalmood{% else %}Ø£ÙŠØ§Ù…{% endif %})';
        result.style.color = '#059669';
    }
}
</script>
{% endblock %}
